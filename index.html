<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Morelia Taste-Router MVP</title>
  <style>
    :root {
      color-scheme: light dark;
      font-family: 'Inter', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #0b1117;
      color: #f5f7fa;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 32px 16px;
      background: radial-gradient(circle at top, #1f2a37 0%, #0b1117 60%);
    }

    .app {
      width: min(720px, 100%);
      background: rgba(18, 26, 33, 0.92);
      border-radius: 20px;
      padding: 32px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.45);
      backdrop-filter: blur(18px);
    }

    header h1 {
      margin: 0 0 8px;
      font-size: clamp(1.8rem, 3vw, 2.4rem);
      letter-spacing: -0.02em;
    }

    header p {
      margin: 0 0 24px;
      color: #cdd5df;
    }

    .question-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      color: #94a3b8;
      font-size: 0.9rem;
    }

    .question-card {
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(148, 163, 184, 0.14);
      border-radius: 16px;
      padding: 24px;
    }

    .question-card h2 {
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 1.3rem;
      font-weight: 600;
    }

    .options {
      display: grid;
      gap: 16px;
    }

    .option-btn {
      border: 1px solid rgba(148, 163, 184, 0.2);
      border-radius: 12px;
      padding: 18px;
      background: rgba(15, 23, 42, 0.6);
      color: inherit;
      text-align: left;
      font-size: 1rem;
      cursor: pointer;
      transition: transform 0.15s ease, border 0.15s ease, background 0.15s ease;
    }

    .option-btn:hover,
    .option-btn:focus {
      outline: none;
      border-color: #38bdf8;
      background: rgba(56, 189, 248, 0.12);
      transform: translateY(-2px);
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: rgba(148, 163, 184, 0.2);
      border-radius: 999px;
      overflow: hidden;
      margin-bottom: 24px;
    }

    .progress-bar span {
      display: block;
      height: 100%;
      background: linear-gradient(90deg, #38bdf8, #818cf8);
      width: 0;
      transition: width 0.3s ease;
    }

    .hidden {
      display: none;
    }

    #result {
      margin-top: 24px;
    }

    .summary {
      margin-bottom: 24px;
      padding: 16px 20px;
      border-radius: 12px;
      background: rgba(148, 163, 184, 0.12);
      color: #e2e8f0;
    }

    .summary h3 {
      margin-top: 0;
      margin-bottom: 12px;
      font-size: 1.1rem;
    }

    .summary ul {
      margin: 0;
      padding-left: 18px;
      color: #cbd5e1;
    }

    .venue-card {
      margin-bottom: 20px;
      padding: 24px;
      border-radius: 16px;
      border: 1px solid rgba(148, 163, 184, 0.2);
      background: rgba(15, 23, 42, 0.75);
    }

    .venue-card h3 {
      margin: 0 0 8px;
      font-size: 1.3rem;
    }

    .venue-meta {
      font-size: 0.95rem;
      color: #94a3b8;
      margin-bottom: 12px;
    }

    .venue-desc {
      margin: 0 0 12px;
      color: #dbe4ee;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 0.78rem;
      background: rgba(56, 189, 248, 0.18);
      color: #bae6fd;
      margin-right: 8px;
      margin-bottom: 8px;
    }

    .reasons {
      margin: 12px 0 4px;
      padding-left: 18px;
      color: #cbd5e1;
    }

    .highlights {
      margin: 12px 0 0;
      padding-left: 18px;
      color: #e2e8f0;
    }

    .cta-group {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 16px;
    }

    .cta-group a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 12px 18px;
      border-radius: 12px;
      font-weight: 600;
      text-decoration: none;
      color: #0f172a;
      background: #38bdf8;
    }

    .cta-group a.secondary {
      background: rgba(148, 163, 184, 0.3);
      color: #e2e8f0;
    }

    #restart {
      margin-top: 28px;
      padding: 14px 20px;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      border: none;
      cursor: pointer;
      color: #0f172a;
      background: linear-gradient(90deg, #38bdf8, #818cf8);
      width: 100%;
    }

    @media (max-width: 640px) {
      body {
        padding: 20px 12px;
      }
      .app {
        padding: 24px;
      }
      .cta-group {
        flex-direction: column;
      }
      .cta-group a {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <main class="app">
    <header>
      <h1>Morelia Taste-Router · MVP</h1>
      <p>Seis preguntas rápidas para enviarte al lugar adecuado según tu plan, presupuesto y antojo.</p>
    </header>

    <div class="progress-bar"><span id="progress"></span></div>

    <section id="question-container" class="question-card">
      <div class="question-meta">
        <span id="question-count">Pregunta 1 de 6</span>
        <span id="question-tag"></span>
      </div>
      <h2 id="question-prompt"></h2>
      <div class="options" id="options"></div>
    </section>

    <section id="result" class="hidden"></section>

    <button id="restart" class="hidden">Hacer otra búsqueda</button>
  </main>

  <script>
    const questionnaire = [
      {
        id: "intencion",
        prompt: "¿Qué buscas hoy?",
        tag: "Intención",
        options: [
          {
            id: "novedad",
            label: "Sorpréndeme con algo distinto",
            helper: "Propuestas nuevas, chefs creativos",
            tags: ["novedad", "curioso"]
          },
          {
            id: "seguro",
            label: "Quiero algo que ya sé que funciona",
            helper: "Favoritos probados, cero sorpresas",
            tags: ["seguro", "comfort"]
          }
        ]
      },
      {
        id: "compania",
        prompt: "¿Con quién vienes?",
        tag: "Compañía",
        options: [
          {
            id: "pareja",
            label: "Solo o con una persona",
            helper: "Plan íntimo, conversación tranquila",
            tags: ["pareja", "tranquilo"]
          },
          {
            id: "grupo",
            label: "Con familia o amigos",
            helper: "Necesitamos mesa amplia",
            tags: ["grupo"]
          }
        ]
      },
      {
        id: "ambiente",
        prompt: "Elige el ambiente.",
        tag: "Ambiente",
        options: [
          {
            id: "tranquilo",
            label: "Calmado para platicar",
            helper: "Música suave, espacio cómodo",
            tags: ["tranquilo", "quedarse"]
          },
          {
            id: "animado",
            label: "Con energía y música",
            helper: "Ambiente vivo, playlist arriba",
            tags: ["animado"]
          }
        ]
      },
      {
        id: "presupuesto",
        prompt: "¿Cómo quieres gastar?",
        tag: "Presupuesto",
        options: [
          {
            id: "economico",
            label: "Cuidar el bolsillo",
            helper: "Promedio menor a 220 MXN",
            tags: ["economico"]
          },
          {
            id: "premium",
            label: "Me doy un gusto",
            helper: "Estoy listo para invertir más",
            tags: ["premium"]
          }
        ]
      },
      {
        id: "antojo",
        prompt: "¿Qué se te antoja más?",
        tag: "Antojo",
        options: [
          {
            id: "comfort",
            label: "Sabores reconfortantes",
            helper: "Tacos, caldos, parrilla",
            tags: ["comfort", "seguro"]
          },
          {
            id: "creativo",
            label: "Algo diferente o creativo",
            helper: "Sushi, ramen, fusiones",
            tags: ["novedad", "curioso"]
          }
        ]
      },
      {
        id: "logistica",
        prompt: "¿Qué necesitas para hoy?",
        tag: "Logística",
        options: [
          {
            id: "practico",
            label: "Salir rápido o estacionar fácil",
            helper: "Servicio ágil, acceso sencillo",
            tags: ["rapido", "estacionamiento"]
          },
          {
            id: "relajado",
            label: "Quedarme un buen rato",
            helper: "Sillones, sobremesa larga",
            tags: ["quedarse"]
          }
        ]
      }
    ];

    const tagWeights = {
      novedad: 3,
      curioso: 2,
      seguro: 3,
      comfort: 2,
      pareja: 3,
      grupo: 3,
      tranquilo: 3,
      animado: 3,
      economico: 3,
      premium: 3,
      estacionamiento: 2,
      rapido: 2,
      quedarse: 2
    };

    const tagLabels = {
      novedad: "Querías descubrir algo nuevo",
      curioso: "Buscas propuestas creativas",
      seguro: "Preferías una apuesta segura",
      comfort: "Antojo de comida reconfortante",
      pareja: "Plan íntimo o en pareja",
      grupo: "Venías con familia o amigos",
      tranquilo: "Ambiente tranquilo para conversar",
      animado: "Ambiente animado con música",
      economico: "Presupuesto cuidado",
      premium: "Dispuesto a gastar más",
      estacionamiento: "Necesitas estacionamiento sencillo",
      rapido: "Buscas salida rápida",
      quedarse: "Quieres quedarte un buen rato"
    };

    const venues = [
      {
        id: "casa-caldito",
        nombre: "Casa Caldito Moderna",
        barrio: "Centro Histórico",
        descripcion: "Fondita contemporánea con caldos michoacanos y guisos reconfortantes servidos con un toque moderno.",
        precioEstimado: "Cuenta promedio: 180 MXN por persona",
        horario: "Mar-Dom 13:00-22:00",
        tags: { seguro: 3, comfort: 3, economico: 2, grupo: 2, tranquilo: 2, rapido: 2 },
        destacados: [
          "Caldo de corunda con setas y nixtamal propio",
          "Menú del día que cambia según mercado",
          "Estacionamiento conveniado a una cuadra"
        ],
        enlaces: {
          maps: "https://maps.google.com/?q=Casa+Caldito+Moderna+Morelia",
          whatsapp: "https://wa.me/5214435550101?text=Hola%20Casa%20Caldito%2C%20quiero%20reservar%20para%20hoy"
        }
      },
      {
        id: "terraza-brisa",
        nombre: "Terraza Brisa Nocturna",
        barrio: "Chapultepec",
        descripcion: "Terraza con mixología de autor, música en vivo ligera y menú de platillos para compartir.",
        precioEstimado: "Cuenta promedio: 340 MXN por persona",
        horario: "Mié-Dom 18:00-01:00",
        tags: { novedad: 2, premium: 3, animado: 3, pareja: 2, quedarse: 2 },
        destacados: [
          "Cócteles con destilados michoacanos",
          "Playlist curada por DJs locales",
          "Reservados semi-privados con vista a la ciudad"
        ],
        enlaces: {
          maps: "https://maps.google.com/?q=Terraza+Brisa+Nocturna+Morelia",
          whatsapp: "https://wa.me/5214435550202?text=Hola%20Terraza%20Brisa%2C%20busco%20mesa%20para%20hoy"
        }
      },
      {
        id: "neko-ramen",
        nombre: "Neko Ramen Lab",
        barrio: "Nueva España",
        descripcion: "Barra de ramen y baos con productos locales, menús colaborativos y cocina a la vista.",
        precioEstimado: "Cuenta promedio: 260 MXN por persona",
        horario: "Lun-Sáb 14:00-23:00",
        tags: { novedad: 3, curioso: 3, premium: 2, pareja: 2, animado: 1 },
        destacados: [
          "Caldo de hueso rostizado 18 horas",
          "Opciones veganas creativas",
          "Degustación mensual con chefs invitados"
        ],
        enlaces: {
          maps: "https://maps.google.com/?q=Neko+Ramen+Lab+Morelia",
          whatsapp: "https://wa.me/5214435550303?text=Hola%20Neko%20Ramen%2C%20me%20anoto%20a%20la%20barra"
        }
      },
      {
        id: "mercado-azotea",
        nombre: "Mercado Social Azotea",
        barrio: "Centro Sur",
        descripcion: "Azotea compartida con estaciones de comida urbana, cerveza artesanal y mesas comunitarias.",
        precioEstimado: "Cuenta promedio: 210 MXN por persona",
        horario: "Jue-Dom 15:00-00:00",
        tags: { grupo: 3, animado: 3, novedad: 2, economico: 2, rapido: 1 },
        destacados: [
          "Once proyectos de cocina rotativa",
          "Música en vivo jueves a sábado",
          "Vista panorámica a Catedral"
        ],
        enlaces: {
          maps: "https://maps.google.com/?q=Mercado+Social+Azotea+Morelia",
          whatsapp: "https://wa.me/5214435550404?text=Hola%20Mercado%20Azotea%2C%20somos%20un%20grupo"
        }
      },
      {
        id: "parrilla-bosque",
        nombre: "Parrilla del Bosque",
        barrio: "Tres Marías",
        descripcion: "Asador campestre con cortes añejados, barra de ensaladas y terraza rodeada de pinos.",
        precioEstimado: "Cuenta promedio: 380 MXN por persona",
        horario: "Vie-Dom 13:00-23:00",
        tags: { seguro: 3, premium: 2, grupo: 2, estacionamiento: 3, comfort: 2, quedarse: 2 },
        destacados: [
          "Cortes dry-aged de 28 días",
          "Jardín para niñas y niños con monitoreo",
          "Valet parking incluido"
        ],
        enlaces: {
          maps: "https://maps.google.com/?q=Parrilla+del+Bosque+Morelia",
          whatsapp: "https://wa.me/5214435550505?text=Hola%20Parrilla%20del%20Bosque%2C%20quiero%20reservar"
        }
      },
      {
        id: "ruta-72",
        nombre: "Taquería Ruta 72",
        barrio: "Chapultepec Sur",
        descripcion: "Taquería nocturna con trompo al carbón, salsas de temporada y servicio exprés.",
        precioEstimado: "Cuenta promedio: 120 MXN por persona",
        horario: "Todos los días 19:00-03:00",
        tags: { economico: 3, rapido: 3, grupo: 2, animado: 2, comfort: 1 },
        destacados: [
          "Pastor al cuádruple sellado",
          "Salsa de piña rostizada con chile manzano",
          "Auto-servicio de bebidas y refill gratuito"
        ],
        enlaces: {
          maps: "https://maps.google.com/?q=Taqueria+Ruta+72+Morelia",
          whatsapp: "https://wa.me/5214435550606?text=Hola%20Ruta%2072%2C%20voy%20de%20camino"
        }
      },
      {
        id: "cafe-luz",
        nombre: "Café Luz y Sombra",
        barrio: "Centro Histórico",
        descripcion: "Café de especialidad y vinito natural en casona del siglo XIX con rincones íntimos.",
        precioEstimado: "Cuenta promedio: 230 MXN por persona",
        horario: "Mar-Dom 09:00-22:00",
        tags: { pareja: 3, tranquilo: 3, quedarse: 3, premium: 2, novedad: 1 },
        destacados: [
          "Carta de cafés de origen michoacano",
          "Brunch de temporada con productos locales",
          "Sala de lectura y vinilos"
        ],
        enlaces: {
          maps: "https://maps.google.com/?q=Cafe+Luz+y+Sombra+Morelia",
          whatsapp: "https://wa.me/5214435550707?text=Hola%20Caf%C3%A9%20Luz%2C%20quiero%20una%20mesa"
        }
      },
      {
        id: "ola-verde",
        nombre: "Mariscos La Ola Verde",
        barrio: "Camelinas",
        descripcion: "Marisquería fresca con ceviches creativos, barra de aguachiles y opciones saludables.",
        precioEstimado: "Cuenta promedio: 290 MXN por persona",
        horario: "Mié-Lun 12:00-21:00",
        tags: { novedad: 2, grupo: 2, premium: 2, tranquilo: 1, estacionamiento: 2, curioso: 1 },
        destacados: [
          "Aguachile verde con cítricos locales",
          "Opciones sin gluten y veg-friendly",
          "Servicio de valet y zona techada"
        ],
        enlaces: {
          maps: "https://maps.google.com/?q=Mariscos+La+Ola+Verde+Morelia",
          whatsapp: "https://wa.me/5214435550808?text=Hola%20Ola%20Verde%2C%20necesito%20mesa"
        }
      }
    ];

    const questionContainer = document.getElementById('question-container');
    const questionPrompt = document.getElementById('question-prompt');
    const optionsContainer = document.getElementById('options');
    const questionCount = document.getElementById('question-count');
    const questionTag = document.getElementById('question-tag');
    const progressBar = document.getElementById('progress');
    const resultSection = document.getElementById('result');
    const restartBtn = document.getElementById('restart');

    let currentIndex = 0;
    let selections = [];

    function renderQuestion() {
      const question = questionnaire[currentIndex];
      questionPrompt.textContent = question.prompt;
      questionCount.textContent = `Pregunta ${currentIndex + 1} de ${questionnaire.length}`;
      questionTag.textContent = question.tag;
      const progress = (currentIndex / questionnaire.length) * 100;
      progressBar.style.width = `${progress}%`;

      optionsContainer.innerHTML = '';
      question.options.forEach((option) => {
        const button = document.createElement('button');
        button.className = 'option-btn';
        button.innerHTML = `<strong>${option.label}</strong><br /><span style="color:#94a3b8;font-size:0.9rem;">${option.helper}</span>`;
        button.addEventListener('click', () => handleAnswer(option));
        optionsContainer.appendChild(button);
      });
    }

    function handleAnswer(option) {
      const question = questionnaire[currentIndex];
      selections.push({ questionId: question.id, prompt: question.prompt, option });
      if (currentIndex < questionnaire.length - 1) {
        currentIndex += 1;
        renderQuestion();
      } else {
        progressBar.style.width = '100%';
        showResults();
      }
    }

    function aggregateSelections() {
      const totals = {};
      selections.forEach(({ option }) => {
        option.tags.forEach((tag) => {
          const weight = tagWeights[tag] || 1;
          totals[tag] = (totals[tag] || 0) + weight;
        });
      });
      return totals;
    }

    function rankVenues(tagTotals) {
      return venues
        .map((venue) => {
          let score = 0;
          const reasons = [];
          for (const [tag, value] of Object.entries(tagTotals)) {
            const venueWeight = venue.tags[tag];
            if (venueWeight) {
              const contribution = value * venueWeight;
              score += contribution;
              reasons.push({
                tag,
                label: tagLabels[tag] || tag,
                contribution
              });
            }
          }
          reasons.sort((a, b) => b.contribution - a.contribution);
          return { ...venue, score, reasons: reasons.slice(0, 3) };
        })
        .filter((venue) => venue.score > 0)
        .sort((a, b) => b.score - a.score);
    }

    function showResults() {
      questionContainer.classList.add('hidden');
      resultSection.classList.remove('hidden');
      restartBtn.classList.remove('hidden');

      const tagTotals = aggregateSelections();
      const ranked = rankVenues(tagTotals);

      const summaryItems = selections
        .map((item) => `<li><strong>${item.prompt}</strong>: ${item.option.label}</li>`)
        .join('\n');

      let html = `
        <div class="summary">
          <h3>Tus respuestas</h3>
          <ul>${summaryItems}</ul>
        </div>
      `;

      if (!ranked.length) {
        html += '
          <p>No encontramos coincidencias claras. Ajusta tus respuestas y vuelve a intentar.</p>
        ';
      } else {
        html += '
          <h2>Mejores coincidencias</h2>
        ';
        ranked.slice(0, 3).forEach((venue, index) => {
          const reasonList = venue.reasons
            .map((reason) => `<li>${reason.label}</li>`)
            .join('\n');
          const highlights = venue.destacados
            .map((item) => `<li>${item}</li>`)
            .join('\n');

          html += `
            <article class="venue-card">
              <div class="pill">#${index + 1}</div>
              <h3>${venue.nombre}</h3>
              <div class="venue-meta">${venue.barrio} · ${venue.horario}</div>
              <p class="venue-desc">${venue.descripcion}</p>
              <p class="venue-meta">${venue.precioEstimado}</p>
              ${reasonList ? `<ul class="reasons">${reasonList}</ul>` : ''}
              ${highlights ? `<ul class="highlights">${highlights}</ul>` : ''}
              <div class="cta-group">
                <a href="${venue.enlaces.maps}" target="_blank" rel="noopener">Ver en Maps</a>
                <a class="secondary" href="${venue.enlaces.whatsapp}" target="_blank" rel="noopener">Escribir por WhatsApp</a>
              </div>
            </article>
          `;
        });
      }

      resultSection.innerHTML = html;
    }

    function restartFlow() {
      currentIndex = 0;
      selections = [];
      progressBar.style.width = '0%';
      resultSection.classList.add('hidden');
      restartBtn.classList.add('hidden');
      questionContainer.classList.remove('hidden');
      renderQuestion();
    }

    restartBtn.addEventListener('click', restartFlow);

    renderQuestion();
  </script>
</body>
</html>
